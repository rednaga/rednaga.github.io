<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Reversing GO binaries like a pro | RedNaga Security</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="GO binaries are weird, or at least, that is where this all started out. While delving into some Linux malware named Rex, I came to the realization that I might need to understand more than I wanted to">
<meta property="og:type" content="article">
<meta property="og:title" content="Reversing GO binaries like a pro">
<meta property="og:url" content="https://rednaga.github.io/2016/09/21/reversing_go_binaries_like_a_pro/index.html">
<meta property="og:site_name" content="RedNaga Security">
<meta property="og:description" content="GO binaries are weird, or at least, that is where this all started out. While delving into some Linux malware named Rex, I came to the realization that I might need to understand more than I wanted to">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/unstripped_main.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/unstripped_main_main.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/stripped_start.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/stripped_main_main.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/stripped_runtime_morestack_noctxt.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/unstripped_runtime_morestack.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/stripped_0808994B.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/stripped_rex_no_strings.png">
<meta property="og:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/stripped_rex_strings.png">
<meta property="og:updated_time" content="2016-09-23T23:10:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reversing GO binaries like a pro">
<meta name="twitter:description" content="GO binaries are weird, or at least, that is where this all started out. While delving into some Linux malware named Rex, I came to the realization that I might need to understand more than I wanted to">
<meta name="twitter:image" content="https://rednaga.github.io/images/reversing_go_binaries_like_a_pro/unstripped_main.png">
<meta name="twitter:creator" content="@RedNagaSec">
  
    <link rel="alternative" href="/rss2.xml" title="RedNaga Security" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-81741124-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">RedNaga Security</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">spicy security research</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/rss2.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://rednaga.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-reversing_go_binaries_like_a_pro" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/21/reversing_go_binaries_like_a_pro/" class="article-date">
  <time datetime="2016-09-21T07:00:00.000Z" itemprop="datePublished">2016-09-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Reversing GO binaries like a pro
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>GO binaries are weird, or at least, that is where this all started out. While delving into some <a href="http://securityaffairs.co/wordpress/50556/malware/linux-rex-1-botnet.html" target="_blank" rel="external">Linux malware named Rex</a>, I came to the realization that I might need to understand more than I wanted to. Just the prior week I had been reversing <a href="https://news.drweb.com/news/?i=10140&amp;lng=en" target="_blank" rel="external">Linux Lady</a> which was also written in GO, however it was not a stripped binary so it was pretty easy. Clearly the binary was rather large, many extra methods I didn’t care about - though I really just didn’t understand why. To be honest - I still haven’t fully dug into the Golang code and have yet to really write much code in Go, so take this information at face value as some of it might be incorrect; this is just my experience while reversing some ELF Go binaries!</p>
<p>To illistrate some of my examples I’m going to use an extremely simple ‘Hello, World!’ example and also reference the Rex malware. The code and a Make file are extremely simple;</p>
<figure class="highlight go"><figcaption><span>Hello.go</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    fmt.Println(<span class="string">"Hello, World!"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><figcaption><span>Makefile</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">all:</div><div class="line">	GOOS=linux GOARCH=386 go build -o hello-stripped -ldflags <span class="string">"-s"</span> hello.go</div><div class="line">	GOOS=linux GOARCH=386 go build -o hello-normal hello.go</div></pre></td></tr></table></figure>
<p>Since I’m working on an OSX machine, the above <code>GOOS</code> and <code>GOARCH</code> variables are explicitly needed to cross-compile this correctly. The first line also added the <code>ldflags</code> option to strip the binary. This way we can analyze the same executable both stripped and without being stripped. Copy these files, run <code>make</code> and then open up the files in your disassembler of choice, for this blog I’m going to use IDA Pro. If we open up the unstripped binary in IDA Pro we can notice a few quick things;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/unstripped_main.png" alt=""></p>
<p>Well then - our 5 lines of code has turned into over 2058 functions. With all that overhead of what appears to be a runtime, we also have nothing interesting in the <code>main()</code> function. If we dig in a bit further we can see that the actual code we’re interested in is inside of <code>main_main</code>;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/unstripped_main_main.png" alt=""></p>
<p>This is, well, lots of code that I honestly don’t want to look at. The string loading also looks a bit weird - though IDA seems to have done a good job identifying the necessary bits. We can easily see that the string load is actually a set of three <code>mov</code>s;</p>
<figure class="highlight plain"><figcaption><span>String load</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mov     ebx, offset aHelloWorld ; &quot;Hello, World!&quot;</div><div class="line">mov     [esp+3Ch+var_14], ebx ; Shove string into location</div><div class="line">mov     [esp+3Ch+var_10], 0Dh ; length of string</div></pre></td></tr></table></figure>
<p>This isn’t exactly revolutionary, though I can’t off the top of my head say that I’ve seen something like this before. We’re also taking note of it as this will come in handle later on. The other tidbit of code which caught my eye was the <code>runtime_morestack_context</code> call;</p>
<figure class="highlight plain"><figcaption><span>morestack_context</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">loc_80490CB:</div><div class="line">call    runtime_morestack_noctxt</div><div class="line">jmp     main_main</div></pre></td></tr></table></figure>
<p>This style block of code appears to always be at the end of functions and it also seems to always loop back up to the top of the same function. This is verified by looking at the cross-references to this function. Ok, now that we know IDA Pro can handle unstripped binaries, lets load the same code but the stripped version this time.</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/stripped_start.png" alt=""></p>
<p>Immediately we see some, well, lets just call them “differences”. We have 1329 functions defined and now seem some undefined code by looking at the navigator toolbar. Luckily IDA has still been able to find the string load we are looking for, however this function now seems much less friendly to deal with.</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/stripped_main_main.png" alt=""></p>
<p>We now have no more function names, however - the function names appear to be retained in a specific section of the binary if we do a string search for <code>main.main</code> (which would be repesented at <code>main_main</code> in the previous screen shots due to how a <code>.</code> is interpreted by IDA);</p>
<figure class="highlight plain"><figcaption><span>.gopclntab</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.gopclntab:0813E174                 db  6Dh ; m</div><div class="line">.gopclntab:0813E175                 db  61h ; a</div><div class="line">.gopclntab:0813E176                 db  69h ; i</div><div class="line">.gopclntab:0813E177                 db  6Eh ; n</div><div class="line">.gopclntab:0813E178                 db  2Eh ; .</div><div class="line">.gopclntab:0813E179                 db  6Dh ; m</div><div class="line">.gopclntab:0813E17A                 db  61h ; a</div><div class="line">.gopclntab:0813E17B                 db  69h ; i</div><div class="line">.gopclntab:0813E17C                 db  6Eh ; n</div></pre></td></tr></table></figure>
<p>Alright, so it would appear that there is something left over here. After digging into some of the Google results into <code>gopclntab</code> and tweet about this - a friendly reverse <a href="https://twitter.com/groke1105" target="_blank" rel="external">George (Egor?) Zaytsev</a> showed me his IDA Pro scripts for <a href="https://gitlab.com/zaytsevgu/goutils" target="_blank" rel="external">renaming function and adding type information</a>. After skimming these it was pretty easy to figure out the format of this section so I through together some functionally to replicate his script. The essential code is shown below, very simply put, we look into the segment <code>.gopclntab</code> and skip the first 8 bytes. We then create a pointer (<code>Qword</code> or ~<code>Dword</code> dependant on whether the binary is 64bit or not). The first set of data actually gives us the size of the <code>.gopclntab</code> table, so we know how far to go into this structure. Now we can start processing the rest of the data which appears to be the <code>function_offset</code> followed by the (function) <code>name_offset</code>). As we create pointers to these offsets and also tell IDA to create the strings, we just need to ensure we don’t pass <code>MakeString</code> any bad characters so we use the <code>clean_function_name</code> function to strip out any badness. </p>
<figure class="highlight python"><figcaption><span>renamer.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_pointer</span><span class="params">(addr, force_size=None)</span>:</span></div><div class="line">    <span class="keyword">if</span> force_size <span class="keyword">is</span> <span class="keyword">not</span> <span class="number">4</span> <span class="keyword">and</span> (idaapi.get_inf_structure().is_64bit() <span class="keyword">or</span> force_size <span class="keyword">is</span> <span class="number">8</span>):</div><div class="line">        MakeQword(addr)</div><div class="line">	<span class="keyword">return</span> Qword(addr), <span class="number">8</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">	MakeDword(addr)</div><div class="line">	<span class="keyword">return</span> Dword(addr), <span class="number">4</span></div><div class="line"></div><div class="line">STRIP_CHARS = [ <span class="string">'('</span>, <span class="string">')'</span>, <span class="string">'['</span>, <span class="string">']'</span>, <span class="string">'&#123;'</span>, <span class="string">'&#125;'</span>, <span class="string">' '</span>, <span class="string">'"'</span> ]</div><div class="line">REPLACE_CHARS = [<span class="string">'.'</span>, <span class="string">'*'</span>, <span class="string">'-'</span>, <span class="string">','</span>, <span class="string">';'</span>, <span class="string">':'</span>, <span class="string">'/'</span>, <span class="string">'\xb7'</span> ]</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">clean_function_name</span><span class="params">(str)</span>:</span></div><div class="line">    <span class="comment"># Kill generic 'bad' characters</span></div><div class="line">    str = filter(<span class="keyword">lambda</span> x: x <span class="keyword">in</span> string.printable, str)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> STRIP_CHARS:</div><div class="line">        str = str.replace(c, <span class="string">''</span>)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> REPLACE_CHARS:</div><div class="line">        str = str.replace(c, <span class="string">'_'</span>)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> str</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">renamer_init</span><span class="params">()</span>:</span></div><div class="line">    renamed = <span class="number">0</span></div><div class="line"></div><div class="line">    gopclntab = ida_segment.get_segm_by_name(<span class="string">'.gopclntab'</span>)</div><div class="line">    <span class="keyword">if</span> gopclntab <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        <span class="comment"># Skip unimportant header and goto section size</span></div><div class="line">        addr = gopclntab.startEA + <span class="number">8</span></div><div class="line">        size, addr_size = create_pointer(addr)</div><div class="line">        addr += addr_size</div><div class="line"></div><div class="line">        <span class="comment"># Unsure if this end is correct</span></div><div class="line">        early_end = addr + (size * addr_size * <span class="number">2</span>)</div><div class="line">        <span class="keyword">while</span> addr &lt; early_end:</div><div class="line">            func_offset, addr_size = create_pointer(addr)</div><div class="line">            name_offset, addr_size = create_pointer(addr + addr_size)</div><div class="line">            addr += addr_size * <span class="number">2</span></div><div class="line"></div><div class="line">            func_name_addr = Dword(name_offset + gopclntab.startEA + addr_size) + gopclntab.startEA</div><div class="line">            func_name = GetString(func_name_addr)</div><div class="line">            MakeStr(func_name_addr, func_name_addr + len(func_name))</div><div class="line">            appended = clean_func_name = clean_function_name(func_name)</div><div class="line">            debug(<span class="string">'Going to remap function at 0x%x with %s - cleaned up as %s'</span> % (func_offset, func_name, clean_func_name))</div><div class="line"></div><div class="line">            <span class="keyword">if</span> ida_funcs.get_func_name(func_offset) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">                <span class="keyword">if</span> MakeName(func_offset, clean_func_name):</div><div class="line">                    renamed += <span class="number">1</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    error(<span class="string">'clean_func_name error %s'</span> % clean_func_name)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> renamed</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    renamed = renamer_init()</div><div class="line">    info(<span class="string">'Found and successfully renamed %d functions!'</span> % renamed)</div></pre></td></tr></table></figure>
<p>The above code won’t actually run yet (don’t worry I’ll post the full code) but it hopefully simple enough to read through and understand the process. However, this still doesn’t solve the problem that IDA Pro doesn’t know <em>all</em> the functions. So this is going to create pointers which we aren’t being referenced anywhere. We do know the beginning of functions now, however I ended up seeing (what I think is) an easier way to define all the functions in the application. We can define all the functions by utilizing <code>runtime_morestack_noctxt</code> function. Since every function utilizes this (basically, there is an edgecase it turns out), if we find this function and traverse backwards to the cross references to this function, then we will know where every function exists. So what, right? We already know where ever function started from the segment we just parsed above, right? Ah, well - now we know the end of the function <em>and</em> the next instruction after the call to <code>runtime_morestack_noctxt</code> gives us a jump to the top of the function. This means we should quikcly be able to give the bounds of the start and stop of a function, which is required by IDA, while seperating this from the parsing of the function names. If we open up the window for cross references to the function <code>runtime_morestack_noctxt</code> we see there are many more undefined sections calling into this. 1774 in total things reference this function, which is up from the 1329 functions IDA has already defined for us, this is highlighted by the image below;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/stripped_runtime_morestack_noctxt.png" alt=""></p>
<p>After digging into mutliple binaries we can see the <code>runtime_morestack_noctext</code> will always call into <code>runtime_morestack</code> (with context). This is the edgecase I was referencing before, so between these two functions we should be able to see cross refereneces to ever other function used in the binary. Looking at the larger of the two functions, <code>runtime_more_stack</code>, of multiple binaries tends to have an interesting layout;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/unstripped_runtime_morestack.png" alt=""></p>
<p>The part which stuck out to me was <code>mov large dword ptr ds:1003h, 0</code> - this appeared to be rather constant in all 64bit binaries I saw. So after cross compiling a few more I noticed that 32bit binaries used <code>mov qword ptr ds:1003h, 0</code>, so we will be hunting for this pattern to create a “hook” for traversing backwards on. Lucky for us, I haven’t seen an instance where IDA Pro fails to define this specific function, we don’t really need to spend much brain power mapping it out or defining it outselves. So, enough talk, lets write some code to find this function;</p>
<figure class="highlight python"><figcaption><span>find_runtime_morestack.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_runtime_ms</span><span class="params">()</span>:</span></div><div class="line">    debug(<span class="string">'Attempting to find runtime_morestack function for hooking on...'</span>)</div><div class="line"></div><div class="line">    text_seg = ida_segment.get_segm_by_name(<span class="string">'.text'</span>)</div><div class="line">    <span class="comment"># This code string appears to work for ELF32 and ELF64 AFAIK</span></div><div class="line">    runtime_ms_end = ida_search.find_text(text_seg.startEA, <span class="number">0</span>, <span class="number">0</span>, <span class="string">"word ptr ds:1003h, 0"</span>, SEARCH_DOWN)</div><div class="line">    runtime_ms = ida_funcs.get_func(runtime_ms_end)</div><div class="line">    <span class="keyword">if</span> idc.MakeNameEx(runtime_ms.startEA, <span class="string">"runtime_morecontext"</span>, SN_PUBLIC):</div><div class="line">        debug(<span class="string">'Successfully found runtime_morecontext'</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        debug(<span class="string">'Failed to rename function @ 0x%x to runtime_morestack'</span> % runtime_ms.startEA)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> runtime_ms</div></pre></td></tr></table></figure>
<p>After finding the function, we can recursively traverse backwards through all the function calls, anything which is not inside an already defined function we can now define. This is because the structure always appears to be;</p>
<figure class="highlight plain"><figcaption><span>golang_undefined_function_example</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">.text:08089910				               ; Function start - however undefined currently according to IDA Pro</div><div class="line">.text:08089910 loc_8089910:                            ; CODE XREF: .text:0808994B</div><div class="line">.text:08089910                                         ; DATA XREF: sub_804B250+1A1</div><div class="line">.text:08089910                 mov     ecx, large gs:0</div><div class="line">.text:08089917                 mov     ecx, [ecx-4]</div><div class="line">.text:0808991D                 cmp     esp, [ecx+8]</div><div class="line">.text:08089920                 jbe     short loc_8089946</div><div class="line">.text:08089922                 sub     esp, 4</div><div class="line">.text:08089925                 mov     ebx, [edx+4]</div><div class="line">.text:08089928                 mov     [esp], ebx</div><div class="line">.text:0808992B                 cmp     dword ptr [esp], 0</div><div class="line">.text:0808992F                 jz      short loc_808993E</div><div class="line">.text:08089931</div><div class="line">.text:08089931 loc_8089931:                            ; CODE XREF: .text:08089944</div><div class="line">.text:08089931                 add     dword ptr [esp], 30h</div><div class="line">.text:08089935                 call    sub_8052CB0</div><div class="line">.text:0808993A                 add     esp, 4</div><div class="line">.text:0808993D                 retn</div><div class="line">.text:0808993E ; ---------------------------------------------------------------------------</div><div class="line">.text:0808993E</div><div class="line">.text:0808993E loc_808993E:                            ; CODE XREF: .text:0808992F</div><div class="line">.text:0808993E                 mov     large ds:0, eax</div><div class="line">.text:08089944                 jmp     short loc_8089931</div><div class="line">.text:08089946 ; ---------------------------------------------------------------------------</div><div class="line">.text:08089946</div><div class="line">.text:08089946 loc_8089946:                            ; CODE XREF: .text:08089920</div><div class="line">.text:08089946                 call    runtime_morestack ; &quot;Bottom&quot; of function, calls out to runtime_morestack</div><div class="line">.text:0808994B                 jmp     short loc_8089910 ; Jump back to the &quot;top&quot; of the function</div></pre></td></tr></table></figure>
<p>The above snippet is a random undefined function I pulled from the stripped example application we compiled already. Essentially by traversing backwards into every undefined function, we will land at something like line <code>0x0808994B</code> which is the <code>call runtime_morestack</code>. From here we will skip to the next instruction and ensure it is a jump above where we currently are, if this is true, we can likely assume this is the start of a function. In this example (and almost every test case I’ve run) this is true. Jumping to <code>0x08089910</code> is the start of the function, so now we have the two parameters required by <code>MakeFunction</code> function;</p>
<figure class="highlight python"><figcaption><span>traverse_functions.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_simple_wrapper</span><span class="params">(addr)</span>:</span></div><div class="line">    <span class="keyword">if</span> GetMnem(addr) == <span class="string">'xor'</span> <span class="keyword">and</span> GetOpnd(addr, <span class="number">0</span>) == <span class="string">'edx'</span> <span class="keyword">and</span>  GetOpnd(addr, <span class="number">1</span>) == <span class="string">'edx'</span>:</div><div class="line">        addr = FindCode(addr, SEARCH_DOWN)</div><div class="line">        <span class="keyword">if</span> GetMnem(addr) == <span class="string">'jmp'</span> <span class="keyword">and</span> GetOpnd(addr, <span class="number">0</span>) == <span class="string">'runtime_morestack'</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_runtime_ms</span><span class="params">()</span>:</span></div><div class="line">    debug(<span class="string">'Attempting to find runtime_morestack function for hooking on...'</span>)</div><div class="line"></div><div class="line">    text_seg = ida_segment.get_segm_by_name(<span class="string">'.text'</span>)</div><div class="line">    <span class="comment"># This code string appears to work for ELF32 and ELF64 AFAIK</span></div><div class="line">    runtime_ms_end = ida_search.find_text(text_seg.startEA, <span class="number">0</span>, <span class="number">0</span>, <span class="string">"word ptr ds:1003h, 0"</span>, SEARCH_DOWN)</div><div class="line">    runtime_ms = ida_funcs.get_func(runtime_ms_end)</div><div class="line">    <span class="keyword">if</span> idc.MakeNameEx(runtime_ms.startEA, <span class="string">"runtime_morestack"</span>, SN_PUBLIC):</div><div class="line">        debug(<span class="string">'Successfully found runtime_morestack'</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        debug(<span class="string">'Failed to rename function @ 0x%x to runtime_morestack'</span> % runtime_ms.startEA)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> runtime_ms</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">traverse_xrefs</span><span class="params">(func)</span>:</span></div><div class="line">    func_created = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> func <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> func_created</div><div class="line"></div><div class="line">    <span class="comment"># First</span></div><div class="line">    func_xref = ida_xref.get_first_cref_to(func.startEA)</div><div class="line">    <span class="comment"># Attempt to go through crefs</span></div><div class="line">    <span class="keyword">while</span> func_xref != <span class="number">0xffffffffffffffff</span>:</div><div class="line">        <span class="comment"># See if there is a function already here</span></div><div class="line">        <span class="keyword">if</span> ida_funcs.get_func(func_xref) <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="comment"># Ensure instruction bit looks like a jump</span></div><div class="line">            func_end = FindCode(func_xref, SEARCH_DOWN)</div><div class="line">            <span class="keyword">if</span> GetMnem(func_end) == <span class="string">"jmp"</span>:</div><div class="line">                <span class="comment"># Ensure we're jumping back "up"</span></div><div class="line">                func_start = GetOperandValue(func_end, <span class="number">0</span>)</div><div class="line">                <span class="keyword">if</span> func_start &lt; func_xref:</div><div class="line">                    <span class="keyword">if</span> idc.MakeFunction(func_start, func_end):</div><div class="line">                        func_created += <span class="number">1</span></div><div class="line">                    <span class="keyword">else</span>:</div><div class="line">                        <span class="comment"># If this fails, we should add it to a list of failed functions</span></div><div class="line">                        <span class="comment"># Then create small "wrapper" functions and backtrack through the xrefs of this</span></div><div class="line">                        error(<span class="string">'Error trying to create a function @ 0x%x - 0x%x'</span> %(func_start, func_end))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            xref_func = ida_funcs.get_func(func_xref)</div><div class="line">            <span class="comment"># Simple wrapper is often runtime_morestack_noctxt, sometimes it isn't though...</span></div><div class="line">            <span class="keyword">if</span> is_simple_wrapper(xref_func.startEA):</div><div class="line">                debug(<span class="string">'Stepping into a simple wrapper'</span>)</div><div class="line">                func_created += traverse_xrefs(xref_func)</div><div class="line">            <span class="keyword">if</span> ida_funcs.get_func_name(xref_func.startEA) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> <span class="string">'sub_'</span> <span class="keyword">not</span> <span class="keyword">in</span> ida_funcs.get_func_name(xref_func.startEA):</div><div class="line">                debug(<span class="string">'Function @0x%x already has a name of %s; skipping...'</span> % (func_xref, ida_funcs.get_func_name(xref_func.startEA)))</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                debug(<span class="string">'Function @ 0x%x already has a name %s'</span> % (xref_func.startEA, ida_funcs.get_func_name(xref_func.startEA)))</div><div class="line"></div><div class="line">        func_xref = ida_xref.get_next_cref_to(func.startEA, func_xref) </div><div class="line"></div><div class="line">    <span class="keyword">return</span> func_created</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_func_by_name</span><span class="params">(name)</span>:</span></div><div class="line">    text_seg = ida_segment.get_segm_by_name(<span class="string">'.text'</span>)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> addr <span class="keyword">in</span> Functions(text_seg.startEA, text_seg.endEA):</div><div class="line">        <span class="keyword">if</span> name == ida_funcs.get_func_name(addr):</div><div class="line">            <span class="keyword">return</span> ida_funcs.get_func(addr)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">runtime_init</span><span class="params">()</span>:</span></div><div class="line">    func_created = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> find_func_by_name(<span class="string">'runtime_morestack'</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        func_created += traverse_xrefs(find_func_by_name(<span class="string">'runtime_morestack'</span>))</div><div class="line">        func_created += traverse_xrefs(find_func_by_name(<span class="string">'runtime_morestack_noctxt'</span>))</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        runtime_ms = create_runtime_ms()</div><div class="line">        func_created = traverse_xrefs(runtime_ms)</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">return</span> func_created</div></pre></td></tr></table></figure>
<p>That code bit is a bit lengthy, though hopefully the comments and concept is clear enough. It likely isn’t necessary to explicitly traverse backwards recursively, however I wrote this prior to understanding that <code>runtime_morestack_noctxt</code> (the edgecase) is the only edgecase that I would encounter. This was being handled by the <code>is_simple_wrapper</code> function originally. Regardless, running this style of code ended up finding all the extra functions IDA Pro was missing. We can see below, that this creates a much cleaner and easier experience to reverse;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/stripped_0808994B.png" alt=""></p>
<p>This can allow us to use something like <a href="https://github.com/joxeankoret/diaphora" target="_blank" rel="external">Diaphora</a> as well since we can specifically target functions with the same names, if we care too. I’ve personally found this is extremely useful for malware or other targets where you <em>really</em> don’t care about any of the framework/runtime functions. You can quiet easily differentiate between custom code written for the binary, for example in the Linux malware “Rex” everything because with that name space! Now onto the last challenge that I wanted to solve while reversing the malware, string loading! I’m honestly not 100% sure how IDA detects most string loads, potentially through idioms of some sort? Or maybe because it can detect strings based on the <code>\00</code> character at the end of it? Regardless, Go seems to use a string table of some sort, without requiring null character. The appear to be in alpha-numeric order, group by string length size as well. This means we see them all there, but often don’t come across them correctly asserted as strings, or we see them asserted as extremely large blobs of strings. The hello world example isn’t good at illistrating this, so I’ll pull open the <code>main.main</code> function of the Rex malware to show this;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/stripped_rex_no_strings.png" alt=""></p>
<p>I didn’t want to add comments to everything, so I only commented the first few lines then pointed arrows to where there should be pointers to a proper string. We can see a few different use cases and sometimes the destination registers seem to change. However there is definitely a pattern which forms that we can look for. Moving of a pointer into a register, that register is then used to push into a (d)word pointer, followed by a load of a lenght of the string. Cobbling together some python to hunt for the pattern we end with something like the pseudo code below;</p>
<figure class="highlight python"><figcaption><span>string_hunting.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Currently it's normally ebx, but could in theory be anything - seen ebp</span></div><div class="line">VALID_REGS = [<span class="string">'ebx'</span>, <span class="string">'ebp'</span>]</div><div class="line"></div><div class="line"><span class="comment"># Currently it's normally esp, but could in theory be anything - seen eax</span></div><div class="line">VALID_DEST = [<span class="string">'esp'</span>, <span class="string">'eax'</span>, <span class="string">'ecx'</span>, <span class="string">'edx'</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_string_load</span><span class="params">(addr)</span>:</span></div><div class="line">    patterns = []</div><div class="line">    <span class="comment"># Check for first part</span></div><div class="line">    <span class="keyword">if</span> GetMnem(addr) == <span class="string">'mov'</span>:</div><div class="line">        <span class="comment"># Could be unk_ or asc_, ignored ones could be loc_ or inside []</span></div><div class="line">        <span class="keyword">if</span> GetOpnd(addr, <span class="number">0</span>) <span class="keyword">in</span> VALID_REGS <span class="keyword">and</span> <span class="keyword">not</span> (<span class="string">'['</span> <span class="keyword">in</span> GetOpnd(addr, <span class="number">1</span>) <span class="keyword">or</span> <span class="string">'loc_'</span> <span class="keyword">in</span> GetOpnd(addr, <span class="number">1</span>)) <span class="keyword">and</span>(<span class="string">'offset '</span> <span class="keyword">in</span> GetOpnd(addr, <span class="number">1</span>) <span class="keyword">or</span> <span class="string">'h'</span> <span class="keyword">in</span> GetOpnd(addr, <span class="number">1</span>)):</div><div class="line">            from_reg = GetOpnd(addr, <span class="number">0</span>)</div><div class="line">            <span class="comment"># Check for second part</span></div><div class="line">            addr_2 = FindCode(addr, SEARCH_DOWN)</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                dest_reg = GetOpnd(addr_2, <span class="number">0</span>)[GetOpnd(addr_2, <span class="number">0</span>).index(<span class="string">'['</span>) + <span class="number">1</span>:GetOpnd(addr_2, <span class="number">0</span>).index(<span class="string">'['</span>) + <span class="number">4</span>]</div><div class="line">            <span class="keyword">except</span> ValueError:</div><div class="line">                <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">            <span class="keyword">if</span> GetMnem(addr_2) == <span class="string">'mov'</span> <span class="keyword">and</span> dest_reg <span class="keyword">in</span> VALID_DEST <span class="keyword">and</span> (<span class="string">'[%s'</span> % dest_reg) <span class="keyword">in</span> GetOpnd(addr_2, <span class="number">0</span>) <span class="keyword">and</span> GetOpnd(addr_2, <span class="number">1</span>) == from_reg:</div><div class="line">                <span class="comment"># Check for last part, could be improved</span></div><div class="line">                addr_3 = FindCode(addr_2, SEARCH_DOWN)</div><div class="line">                <span class="keyword">if</span> GetMnem(addr_3) == <span class="string">'mov'</span> <span class="keyword">and</span> ((<span class="string">'[%s+'</span> % dest_reg) <span class="keyword">in</span> GetOpnd(addr_3, <span class="number">0</span>) <span class="keyword">or</span> GetOpnd(addr_3, <span class="number">0</span>) <span class="keyword">in</span> VALID_DEST) <span class="keyword">and</span> <span class="string">'offset '</span> <span class="keyword">not</span> <span class="keyword">in</span> GetOpnd(addr_3, <span class="number">1</span>) <span class="keyword">and</span> <span class="string">'dword ptr ds'</span> <span class="keyword">not</span> <span class="keyword">in</span> GetOpnd(addr_3, <span class="number">1</span>):</div><div class="line">                    <span class="keyword">try</span>:</div><div class="line">                        dumb_int_test = GetOperandValue(addr_3, <span class="number">1</span>)</div><div class="line">                        <span class="keyword">if</span> dumb_int_test &gt; <span class="number">0</span> <span class="keyword">and</span> dumb_int_test &lt; sys.maxsize:</div><div class="line">                            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">                    <span class="keyword">except</span> ValueError:</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_string</span><span class="params">(addr, string_len)</span>:</span></div><div class="line">    debug(<span class="string">'Found string load @ 0x%x with length of %d'</span> % (addr, string_len))</div><div class="line">    <span class="comment"># This may be overly aggressive if we found the wrong area...</span></div><div class="line">    <span class="keyword">if</span> GetStringType(addr) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> GetString(addr) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> len(GetString(addr)) != string_len:</div><div class="line">        debug(<span class="string">'It appears that there is already a string present @ 0x%x'</span> % addr)</div><div class="line">        MakeUnknown(addr, string_len, DOUNK_SIMPLE)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> GetString(addr) <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">and</span> MakeStr(addr, addr + string_len):</div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="comment"># If something is already partially analyzed (incorrectly) we need to MakeUnknown it</span></div><div class="line">        MakeUnknown(addr, string_len, DOUNK_SIMPLE)</div><div class="line">        <span class="keyword">if</span> MakeStr(addr, addr + string_len):</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        debug(<span class="string">'Unable to make a string @ 0x%x with length of %d'</span> % (addr, string_len))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div></pre></td></tr></table></figure>
<p>The above code could likely be optimized, however it was working for me on the samples I needed. All that would be left is to create another function which hunts through all the defined code segments to look for string loads. Then we can use the pointer to the string and the string length to define a new string using the <code>MakeStr</code>. In the code I ended up using, you need to ensure that IDA Pro hasn’t mistakenly already create the string, as it sometimes tries to, incorrectly. This seems to happen sometimes when a string in the table contains a null character. However, after using code above, this is what we are left with;</p>
<p><img src="/images/reversing_go_binaries_like_a_pro/stripped_rex_strings.png" alt=""></p>
<p>This is a much better piece of code to work with. After we throw together all these functions, we now have the <a href="https://github.com/strazzere/golang_loader_assist/blob/master/golang_loader_assist.py" target="_blank" rel="external">golang_loader_assist.py</a> module for IDA Pro. A word of warning though, I have only had time to test this on a few versions of IDA Pro for OSX, the majority of testing on 6.95. There is also very likely optimizations which should be made or at a bare minimum some reworking of the code. With all that said, I wanted to open source this so others could use this and hopefully contribute back. Also be aware that this script can be painfully slow depending on how large the <code>idb</code> file is, working on a OSX El Capitan (10.11.6) using a 2.2 GHz Intel Core i7 on IDA Pro 6.95 - the string discovery aspect itself can take a while. I’ve often found that running the different methods seperately can prevent IDA from locking up. Hopefully this blog and the code proves useful to someone though, enjoy!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rednaga.github.io/2016/09/21/reversing_go_binaries_like_a_pro/" data-id="citgdtyv7000149vbmamzboqa" class="article-share-link">Share</a>
      
        <a href="https://rednaga.github.io/2016/09/21/reversing_go_binaries_like_a_pro/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ida-pro/">ida pro</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/research/">research</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/07/31/detecting_pirated_and_malicious_android_apps_with_apkid/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Detecting Pirated and Malicious Android Apps with APKiD</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/09/21/reversing_go_binaries_like_a_pro/">Reversing GO binaries like a pro</a>
          </li>
        
          <li>
            <a href="/2016/07/31/detecting_pirated_and_malicious_android_apps_with_apkid/">Detecting Pirated and Malicious Android Apps with APKiD</a>
          </li>
        
          <li>
            <a href="/2016/07/30/apkid_and_android_compiler_fingerprinting/">APKiD and Android Compiler Fingerprinting</a>
          </li>
        
          <li>
            <a href="/2016/07/19/welcome/">Welcome to RedNaga</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
  <h3 class="widget-title">Pages</h3>
  <div class="widget pages">
    <a href="/team-rednaga">Team RedNaga</a>
  </div>
</div>

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/apkid/">apkid</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ida-pro/">ida pro</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/research/">research</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/apkid/" style="font-size: 15px;">apkid</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/ida-pro/" style="font-size: 10px;">ida pro</a> <a href="/tags/research/" style="font-size: 20px;">research</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
    <div id="twitter-feed" class="widget-wrap">
  <h3 class="widget-title">Twitter Feed</h3>
  <div class="widget">
    <a class="twitter-timeline" href="https://twitter.com/RedNagaSec">Tweets by RedNagaSec</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 RedNaga<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'rednaga';
  
  var disqus_url = 'https://rednaga.github.io/2016/09/21/reversing_go_binaries_like_a_pro/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>